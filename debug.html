<!DOCTYPE html>
<html>

<head>
    <title>Flutter Debug</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .log {
            background: #f0f0f0;
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
        }

        .error {
            background: #ffebee;
            color: #c62828;
        }

        .success {
            background: #e8f5e8;
            color: #2e7d32;
        }

        #flutter-container {
            width: 100%;
            height: 400px;
            border: 2px solid #ccc;
            margin: 20px 0;
        }
    </style>
</head>

<body>
    <h1>Flutter Web Debug Page</h1>

    <div id="logs"></div>

    <div id="flutter-container">
        <p>Flutter app will load here...</p>
    </div>

    <script>
        function log(message, type = 'info') {
            const logsDiv = document.getElementById('logs');
            const logDiv = document.createElement('div');
            logDiv.className = `log ${type}`;
            logDiv.innerHTML = `<strong>${new Date().toLocaleTimeString()}:</strong> ${message}`;
            logsDiv.appendChild(logDiv);
            console.log(message);
        }

        // Log all errors
        window.addEventListener('error', function (e) {
            log(`JavaScript Error: ${e.message} at ${e.filename}:${e.lineno}`, 'error');
        });

        // Log when Flutter loader is available
        window.addEventListener('load', function () {
            log('Page loaded, checking for Flutter...');

            setTimeout(() => {
                if (window._flutter && window._flutter.loader) {
                    log('Flutter loader found!', 'success');
                    loadFlutter();
                } else {
                    log('Flutter loader not found', 'error');
                }
            }, 1000);
        });

        function loadFlutter() {
            log('Loading Flutter app...');

            _flutter.loader.load({
                serviceWorker: {
                    serviceWorkerVersion: null,
                },
                onEntrypointLoaded: function (engineInitializer) {
                    log('Entrypoint loaded, initializing engine...', 'success');
                    engineInitializer.initializeEngine().then(function (appRunner) {
                        log('Engine initialized, running app...', 'success');
                        appRunner.runApp();
                    }).catch(function (error) {
                        log(`Engine initialization failed: ${error}`, 'error');
                    });
                }
            }).catch(function (error) {
                log(`Flutter loading failed: ${error}`, 'error');
            });
        }
    </script>

    <!-- Load Flutter -->
    <script src="http://localhost:3011/flutter.js" defer></script>
</body>

</html>
